# CODEX-TASK: 集中モードを「アイドリング方式」に全面リニューアル

## 概要

`src/app/focus/page.tsx` の既存ポモドーロタイマー（25分カウントダウン方式）を、
ADHD向け「アイドリング方式」タイマーに全面書き換える。

コンセプト: **「まず1分だけ」のハードルの低さで動き出しを促し、乗ってきたら自由に作業を続ける。**

## ステートマシン（6状態）

```
idle → idling → idling_done → working → work_break → idling（ループ）
                    ↓
              idling_break → idling（ループ）
```

| State | 表示名 | タイマー | リングの色 | 説明 |
|-------|--------|---------|-----------|------|
| `idle` | 待機中... | 00:00（停止） | グレー（薄い） | 初期状態。Playボタンで開始 |
| `idling` | アイドリング中... | 1分カウントダウン（60→0） | オレンジ（進行に応じて塗られる） | 1分だけのウォームアップ |
| `idling_done` | （選択中） | 経過時間をカウントアップ | オレンジ（フル） | 1分経過後。「続行」or「休憩」を選択 |
| `idling_break` | アイドリング休憩 | 1分カウントダウン（60→0） | ブルー | 休憩後、再びidlingへ |
| `working` | 作業中 | カウントアップ（00:00→上へ） | オレンジ（フル） | 自由作業。スキップで休憩へ |
| `work_break` | 休憩中 | 5分カウントダウン（300→0） | ブルー | 作業時間を表示。終了後idlingへ |

## 遷移フロー詳細

1. **idle → idling**: Playボタン押下
2. **idling（1分経過）→ idling_done**: 自動遷移（タイマー音あり）
3. **idling_done → working**: 「続行」ボタン押下
4. **idling_done → idling_break**: 「休憩」ボタン押下
5. **idling_break（1分経過）→ idling**: 自動遷移（タイマー音あり）、自動で再スタート
6. **working → work_break**: スキップ（>）ボタン押下。作業時間を記録
7. **work_break（5分経過）→ idling**: 自動遷移（タイマー音あり）、自動で再スタート

## UI仕様

### レイアウト（上から順）

1. **ヘッダー**: 「← 集中モード」（既存の戻るリンク維持）
2. **タスク表示**: 現在のフォーカスタスク名（既存ロジック維持）
3. **円形タイマー**:
   - 直径: w-64 h-64
   - 外周リング: strokeWidth 6px
   - リング色: オレンジ（`#F97316` = Tailwind orange-500）で作業系、ブルー（`#3B82F6` = Tailwind blue-500）で休憩系
   - 背景リング: 薄いオレンジ or 薄いブルー（state に応じる）
   - 中央: 時間表示（text-5xl font-extrabold） + ステータスラベル（text-xs、色付き）
4. **コントロールボタン**（横並び3つ）:
   - Play/Pause: 72x72 オレンジ丸ボタン（bg-orange-500）
   - スキップ（>）: 48x48（ChevronRight アイコン）。次のフェーズへ進む
   - リセット（↺）: 48x48（RotateCcw アイコン）。idleに戻す
5. **メッセージカード**: 状態に応じたガイドテキスト（角丸カード内、bg-surface）
6. **選択カード**（idling_done時のみ表示）:
   - 「続行」カード: オレンジ背景（bg-orange-500 text-white）、アイコン + 説明テキスト
   - 「休憩」カード: 白背景（border）、コーヒーアイコン + 説明テキスト
   - 横並び2カラム（grid grid-cols-2 gap-3）

### 各ステートのメッセージ

| State | メッセージ |
|-------|---------|
| `idle` | まずは1分間だけのアイドリング作業を始めましょう！\n1分だけ作業した後は休憩もできるのでまずは1分！ |
| `idling` | アイドリング作業を1分だけ頑張りましょう...\n終了後にこのまま作業を続けるか休憩するかを選べます。\n（中央のスキップボタンで今すぐ選択可能） |
| `idling_done` | アイドリング作業が終了しました。\nこのまま作業を継続するか一度休憩するかを選んでください。 |
| `idling_break` | 1分の休憩を取りましょう。\n休憩終了後に再度1分間のアイドリング作業を行います。 |
| `working` | ナイス継続です！この調子で気の向くまで存分に作業を実施しましょう。\n中央のスキップボタンを押すと休憩に入ることができます。 |
| `work_break` | お疲れ様でした！先ほどの作業時間は{MM:SS}でした！\n5分間の休憩です。（中央のボタンでスキップ可能）\nSNSを見ると次動くのが大変なのでストレッチやコーヒー、軽い掃除などがお勧めですよ！ |

### 選択カード（idling_done時）

**続行カード**:
- 背景: オレンジ（bg-orange-500 text-white rounded-xl p-4）
- アイコン: Monitor or Laptop（lucide-react）
- テキスト: 「続行」「このまま作業を続行します」

**休憩カード**:
- 背景: 白（bg-white border rounded-xl p-4）
- アイコン: Coffee（lucide-react）
- テキスト: 「休憩」「1分の休憩を挟んで再度アイドリング作業を実施します」

## 技術的な注意事項

- **既存のデザインシステム（CSS変数）を維持する**: `var(--color-foreground)`, `var(--color-surface)`, `var(--color-muted)` 等はそのまま使う
- **オレンジ・ブルーの色は直接指定**: `#F97316`（オレンジ）、`#3B82F6`（ブルー）、`#FED7AA`（薄オレンジ）、`#BFDBFE`（薄ブルー）
- **既存のAudio関連ロジック（AudioContext, playTimerSound, ensureAudioContext）はそのまま流用する**
- **既存のuseTasks, useSettings hookはそのまま使う**（settingsからのfocusDuration/breakDurationは使わなくなるが、hookの呼び出し自体は残してOK）
- **サブタスク表示（チェックリスト）は削除してOK**（アイドリング方式では不要）
- **過集中アラート（2時間経過通知）は維持する**
- **`src/app/focus/page.tsx` 1ファイルのみ変更する**。他のファイルは変更しない
- **"use client" ディレクティブを先頭に維持する**
- **lucide-react から必要なアイコンをインポート**: Play, Pause, RotateCcw, ChevronRight, Coffee, Monitor, Droplets, ArrowLeft

## 完了条件

- [ ] 6つの全ステートが正しく遷移する
- [ ] idle: 00:00表示、Play押下でidlingへ
- [ ] idling: 1分カウントダウン、オレンジリング進行、終了でidling_doneへ
- [ ] idling_done: 続行/休憩の選択カード表示、各ボタンが機能する
- [ ] idling_break: 1分カウントダウン、ブルーリング、終了でidlingへ自動遷移
- [ ] working: カウントアップ、オレンジリング全塗り、スキップでwork_breakへ
- [ ] work_break: 5分カウントダウン、ブルーリング、作業時間表示、終了でidlingへ
- [ ] リセットボタンでidleに戻る
- [ ] 音が各フェーズ終了時に鳴る
- [ ] 過集中アラート（2時間）が維持されている
- [ ] `npm run build` が成功する
